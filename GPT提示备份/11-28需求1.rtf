{\rtf1\ansi\ansicpg936\cocoartf2758
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 \uc0\u24403 \u28982 \u21487 \u20197 \u12290 \u20197 \u19979 \u26159 \u23545 \u24744 \u30340 \u38656 \u27714 \u30340 \u24635 \u32467 \u65292 \u29992 \u20110 \u25351 \u23548 \u26410 \u26469 \u30340 \u23545 \u35805 \u65306 \
\
1. **\uc0\u25991 \u26723 \u22788 \u29702 **: \u24744 \u38656 \u35201 \u22788 \u29702 \u19968 \u20010 Excel\u25991 \u26723 \u65292 \u20855 \u20307 \u26159 \u20854 \u21069 22\u34892 \u30340 \u25968 \u25454 \u12290 \
\
2. **\uc0\u20851 \u38190 \u21015 **: \u25991 \u26723 \u20013 \u26377 \u20004 \u20010 \u20851 \u38190 \u21015 \u65306 \'93Term\'94\u21644 \'93geneID\'94\u12290 \u20854 \u20013 \u65292 \'93Term\'94\u21015 \u21253 \u21547 \u21333 \u29420 \u30340 \u21151 \u33021 \u65292 \u32780 \'93geneID\'94\u21015 \u21253 \u21547 \u29992 \u20998 \u21495 \u20998 \u38548 \u30340 \u22810 \u20010 \u22522 \u22240 \u65292 \u36825 \u20123 \u22522 \u22240 \u21487 \u33021 \u26377 \u37325 \u22797 \u12290 \
\
3. **\uc0\u25968 \u25454 \u37325 \u26500 \u38656 \u27714 **: \u24744 \u30340 \u30446 \u26631 \u26159 \u37325 \u26500 \u25968 \u25454 \u65292 \u20351 \u20043 \u21464 \u20026 \u27599 \u20010 \u29420 \u29305 \u30340 \u22522 \u22240 \u23545 \u24212 \u22810 \u20010 \u21151 \u33021 \u12290 \u20855 \u20307 \u26469 \u35828 \u65292 \u26159 \u35201 \u21024 \u38500 \'93geneID\'94\u21015 \u20013 \u27599 \u20010 \u21333 \u20803 \u26684 \u20869 \u30340 \u37325 \u22797 \u22522 \u22240 \u65292 \u28982 \u21518 \u26681 \u25454 \u36825 \u20123 \u29420 \u29305 \u30340 \u22522 \u22240 \u37325 \u26032 \u32452 \u32455 \u25968 \u25454 \u65292 \u20351 \u24471 \u27599 \u20010 \u22522 \u22240 \u23545 \u24212 \u19968 \u20010 \u25110 \u22810 \u20010 \'93Term\'94\u21015 \u20013 \u30340 \u21151 \u33021 \u12290 \
\
4. **\uc0\u32467 \u26524 \u26684 \u24335 **: \u36716 \u25442 \u21518 \u30340 \u34920 \u26684 \u20013 \u65292 \u27599 \u34892 \u20195 \u34920 \u19968 \u20010 \u29420 \u29305 \u30340 \u22522 \u22240 \u65292 \u23545 \u24212 \u30340 \'93Term\'94\u21015 \u21253 \u21547 \u35813 \u22522 \u22240 \u30456 \u20851 \u30340 \u25152 \u26377 \u21151 \u33021 \u65292 \u19981 \u21516 \u21151 \u33021 \u20043 \u38388 \u29992 \u20998 \u21495 \u20998 \u38548 \u12290 \
\
5. **\uc0\u25991 \u20214 \u20445 \u23384 **: \u22788 \u29702 \u21518 \u30340 \u25968 \u25454 \u38656 \u35201 \u20445 \u23384 \u22312 \u19968 \u20010 \u26032 \u30340 Excel\u25991 \u20214 \u20013 \u65292 \u35813 \u25991 \u20214 \u20301 \u20110 \u19982 \u21407 \u25991 \u20214 \u21516 \u19968 \u36335 \u24452 \u19979 \u65292 \u25991 \u20214 \u21517 \u20026 \u21407 \u25991 \u20214 \u21517 \u21518 \u21152 \u19978 \'93result\'94\u12290 \
\
\uc0\u22312 \u26410 \u26469 \u30340 \u23545 \u35805 \u20013 \u65292 \u25105 \u23558 \u26681 \u25454 \u36825 \u20123 \u35814 \u32454 \u20449 \u24687 \u26469 \u24110 \u21161 \u24744 \u22788 \u29702 \u25968 \u25454 \u21644 \u35299 \u20915 \u30456 \u20851 \u38382 \u39064 \u12290 \u22914 \u26524 \u24744 \u26377 \u20219 \u20309 \u26032 \u30340 \u35201 \u27714 \u25110 \u20462 \u25913 \u65292 \u20063 \u35831 \u38543 \u26102 \u21578 \u35785 \u25105 \u12290 \
\
****************************************************************\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
****************************************************************\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
import pandas as pd\
import os\
\
# \uc0\u21152 \u36733 Excel\u25991 \u20214 \u65288 \u35831 \u26367 \u25442 \u20026 \u24744 \u30340 \u25991 \u20214 \u36335 \u24452 \u65289 \
file_path = 'your_file_path'\
\
# \uc0\u20351 \u29992  'openpyxl' \u24341 \u25806 \u35835 \u21462 Excel\u25991 \u20214 \
data = pd.read_excel(file_path, nrows=22, engine='openpyxl')\
\
# \uc0\u20165 \u20445 \u30041 \'93geneID\'94\u21015 \u21644 \'93Term\'94\u21015 \
data = data[['geneID', 'Term']]\
\
# \uc0\u21019 \u24314 \u19968 \u20010 \u23383 \u20856 \u65292 \u29992 \u20110 \u23384 \u20648 \u27599 \u20010 \u22522 \u22240 \u21450 \u20854 \u23545 \u24212 \u30340 \u21151 \u33021 \
gene_to_terms = \{\}\
\
# \uc0\u36941 \u21382 \u21407 \u22987 \u25968 \u25454 \
for _, row in data.iterrows():\
    genes = row['geneID'].split(';')\
    for gene in genes:\
        if gene not in gene_to_terms:\
            gene_to_terms[gene] = set()\
        gene_to_terms[gene].add(row['Term'])\
\
# \uc0\u23558 \u27599 \u20010 \u22522 \u22240 \u23545 \u24212 \u30340 \u21151 \u33021 \u21015 \u34920 \u36716 \u25442 \u20026 \u29992 \u20998 \u21495 \u20998 \u38548 \u30340 \u23383 \u31526 \u20018 \
for gene in gene_to_terms:\
    gene_to_terms[gene] = ';'.join(gene_to_terms[gene])\
\
# \uc0\u23558 \u23383 \u20856 \u36716 \u25442 \u20026 DataFrame\
restructured_data = pd.DataFrame(list(gene_to_terms.items()), columns=['geneID', 'Terms'])\
\
# \uc0\u26500 \u24314 \u26032 \u25991 \u20214 \u30340 \u25991 \u20214 \u21517 \u21644 \u36335 \u24452 \
result_file_path = os.path.splitext(file_path)[0] + 'result.xlsx'\
\
# \uc0\u20445 \u23384 \u22788 \u29702 \u21518 \u30340 \u25968 \u25454 \u21040 \u26032 \u25991 \u20214 \
restructured_data.to_excel(result_file_path, index=False, engine='openpyxl')\
\
print(f"\uc0\u22788 \u29702 \u21518 \u30340 \u25968 \u25454 \u24050 \u20445 \u23384 \u21040 \u65306 \{result_file_path\}")\
}